name: ğŸ¯ Feedback PÃ©dagogique CSS - BarÃ¨me Officiel

on:
  push:
    branches: [ main, master ]
    paths:
      - '**.css'
      - '**.html'
  pull_request:
    branches: [ main, master ]
    paths:
      - '**.css'
      - '**.html'

jobs:
  evaluate-css:
    runs-on: ubuntu-latest
    name: ğŸ“ Ã‰valuation selon BarÃ¨me PÃ©dagogique
    permissions:
      contents: write
    
    steps:
    - name: ğŸ“ RÃ©cupÃ©ration du code
      uses: actions/checkout@v4
    
    - name: ğŸ¯ Ã‰valuation CSS selon BarÃ¨me PÃ©dagogique RÃ©aliste
      id: evaluation
      run: |
        echo "# ğŸ¯ **FEEDBACK DÃ‰TAILLÃ‰ - INTRODUCTION Ã€ CSS**" > feedback.md
        echo "" >> feedback.md
        echo "**Exercice :** $(basename $(pwd))" >> feedback.md
        echo "**Date d'analyse :** $(date '+%d/%m/%Y Ã  %H:%M')" >> feedback.md
        echo "**AnalysÃ© par :** Coach Web Design - Validation PÃ©dagogique" >> feedback.md
        echo "" >> feedback.md
        echo "---" >> feedback.md
        echo "" >> feedback.md
        
        # Initialisation des scores
        SCORE_MAQUETTE=0
        SCORE_SELECTORS=0
        SCORE_TYPO=0
        SCORE_PRACTICES=0
        SCORE_VALIDATION=0
        ERROR_COUNT=0
        
        # Recherche des fichiers
        CSS_FILES=$(find . -name "*.css" -not -path "./node_modules/*" -not -path "./.git/*")
        HTML_FILES=$(find . -name "*.html" -not -path "./node_modules/*" -not -path "./.git/*")
        
        echo "## ğŸš¨ **ERREURS CRITIQUES DÃ‰TECTÃ‰ES**" >> feedback.md
        echo "" >> feedback.md
        
        if [ -z "$CSS_FILES" ]; then
          echo "âŒ **ERREUR CRITIQUE : Aucun fichier CSS trouvÃ© !**" >> feedback.md
          ERROR_COUNT=$((ERROR_COUNT + 10))
        else
          echo "ğŸ“ **Fichiers analysÃ©s :**" >> feedback.md
          for file in $CSS_FILES; do
            echo "- ğŸ¨ \`$file\`" >> feedback.md
          done
          for file in $HTML_FILES; do
            echo "- ğŸ“„ \`$file\`" >> feedback.md
          done
          echo "" >> feedback.md
          
          # ==========================================
          # DÃ‰TECTION DES ERREURS DE SYNTAXE CRITIQUES
          # ==========================================
          
          for file in $CSS_FILES; do
            echo "### ğŸ“„ **Analyse dÃ©taillÃ©e de \`$file\`**" >> feedback.md
            echo "" >> feedback.md
            
            # 1. Point-virgules manquants
            MISSING_SEMICOLONS=0
            grep -n ":" "$file" | while IFS=: read -r line_num line_content; do
              if echo "$line_content" | grep -qE "(/\*|\*/|@media|\{)" || echo "$line_content" | grep -qE "^\s*$"; then
                continue
              fi
              if echo "$line_content" | grep -qE ":\s*[^;{}]*$" && ! echo "$line_content" | grep -qE "{\s*$"; then
                echo "âŒ **Ligne $line_num:** Point-virgule manquant" >> feedback.md
                echo "\`\`\`css" >> feedback.md
                echo "$line_content" >> feedback.md
                echo "\`\`\`" >> feedback.md
                echo "**ğŸ’¡ Solution:** Ajoutez \`;\` Ã  la fin" >> feedback.md
                echo "" >> feedback.md
                MISSING_SEMICOLONS=$((MISSING_SEMICOLONS + 1))
                ERROR_COUNT=$((ERROR_COUNT + 1))
              fi
            done
            
            # 2. Accolades non fermÃ©es
            OPEN_BRACES=$(grep -o "{" "$file" | wc -l)
            CLOSE_BRACES=$(grep -o "}" "$file" | wc -l)
            if [ $OPEN_BRACES -ne $CLOSE_BRACES ]; then
              echo "âŒ **ERREUR CRITIQUE:** Accolades dÃ©sÃ©quilibrÃ©es" >> feedback.md
              echo "- Ouvrantes: $OPEN_BRACES, Fermantes: $CLOSE_BRACES" >> feedback.md
              echo "**ğŸ’¡ Solution:** Chaque \`{\` doit avoir son \`}\`" >> feedback.md
              echo "" >> feedback.md
              ERROR_COUNT=$((ERROR_COUNT + 3))
            fi
            
            # 3. PropriÃ©tÃ©s mal orthographiÃ©es (erreurs typiques dÃ©butants)
            BAD_PROPS=$(grep -cE "(colr|font-siz|margn|widht|heigth|bordr|backgrond):" "$file" 2>/dev/null || echo 0)
            if [ $BAD_PROPS -gt 0 ]; then
              echo "âŒ **$BAD_PROPS propriÃ©tÃ©(s) mal orthographiÃ©e(s) dÃ©tectÃ©e(s)**" >> feedback.md
              grep -n -E "(colr|font-siz|margn|widht|heigth|bordr|backgrond):" "$file" | while IFS=: read -r line_num property_line; do
                echo "**Ligne $line_num:** \`$property_line\`" >> feedback.md
                if echo "$property_line" | grep -q "colr:"; then
                  echo "ğŸ’¡ **Correction:** \`colr\` â†’ \`color\`" >> feedback.md
                fi
                if echo "$property_line" | grep -q "font-siz:"; then
                  echo "ğŸ’¡ **Correction:** \`font-siz\` â†’ \`font-size\`" >> feedback.md
                fi
                if echo "$property_line" | grep -q "margn:"; then
                  echo "ğŸ’¡ **Correction:** \`margn\` â†’ \`margin\`" >> feedback.md
                fi
              done
              echo "" >> feedback.md
              ERROR_COUNT=$((ERROR_COUNT + BAD_PROPS))
            fi
            
            # 4. Couleurs hexadÃ©cimales invalides
            INVALID_COLORS=$(grep -cE "#[0-9a-fA-F]*[g-zG-Z]" "$file" 2>/dev/null || echo 0)
            if [ $INVALID_COLORS -gt 0 ]; then
              echo "âŒ **$INVALID_COLORS couleur(s) hexadÃ©cimale(s) invalide(s)**" >> feedback.md
              grep -n -E "#[0-9a-fA-F]*[g-zG-Z]" "$file" | while IFS=: read -r line_num color_line; do
                echo "**Ligne $line_num:** \`$color_line\`" >> feedback.md
              done
              echo "ğŸ’¡ **Solution:** Utilisez seulement 0-9 et A-F (ex: #FF5733)" >> feedback.md
              echo "" >> feedback.md
              ERROR_COUNT=$((ERROR_COUNT + INVALID_COLORS))
            fi
            
            # 5. Valeurs sans unitÃ©s
            MISSING_UNITS=$(grep -cE "(width|height|margin|padding|font-size):\s*[1-9][0-9]*\s*[;}]" "$file" 2>/dev/null || echo 0)
            if [ $MISSING_UNITS -gt 0 ]; then
              echo "âŒ **$MISSING_UNITS valeur(s) sans unitÃ© dÃ©tectÃ©e(s)**" >> feedback.md
              echo "ğŸ’¡ **Solution:** Ajoutez px, em, %, rem, etc." >> feedback.md
              echo "" >> feedback.md
              ERROR_COUNT=$((ERROR_COUNT + MISSING_UNITS))
            fi
            
            # 6. UnitÃ©s mal Ã©crites (p au lieu de px, e au lieu de em, etc.)
            BAD_UNITS=$(grep -cE "(width|height|margin|padding|font-size):\s*[0-9]+\s*(p|e|re|%m|pix)\s*[;}]" "$file" 2>/dev/null || echo 0)
            if [ $BAD_UNITS -gt 0 ]; then
              echo "âŒ **$BAD_UNITS unitÃ©(s) mal Ã©crite(s) dÃ©tectÃ©e(s)**" >> feedback.md
              grep -n -E "(width|height|margin|padding|font-size):\s*[0-9]+\s*(p|e|re|%m|pix)\s*[;}]" "$file" | while IFS=: read -r line_num unit_line; do
                echo "**Ligne $line_num:** \`$unit_line\`" >> feedback.md
                if echo "$unit_line" | grep -qE "[0-9]+\s*p\s*[;}]"; then
                  echo "ğŸ’¡ **Correction:** \`p\` â†’ \`px\`" >> feedback.md
                fi
                if echo "$unit_line" | grep -qE "[0-9]+\s*e\s*[;}]"; then
                  echo "ğŸ’¡ **Correction:** \`e\` â†’ \`em\`" >> feedback.md
                fi
                if echo "$unit_line" | grep -qE "[0-9]+\s*re\s*[;}]"; then
                  echo "ğŸ’¡ **Correction:** \`re\` â†’ \`rem\`" >> feedback.md
                fi
                if echo "$unit_line" | grep -qE "[0-9]+\s*pix\s*[;}]"; then
                  echo "ğŸ’¡ **Correction:** \`pix\` â†’ \`px\`" >> feedback.md
                fi
              done
              echo "" >> feedback.md
              ERROR_COUNT=$((ERROR_COUNT + BAD_UNITS))
            fi
          done
          
          # ==========================================
          # DÃ‰TECTION DES STYLES INLINE (ERREUR MAJEURE)
          # ==========================================
          
          INLINE_STYLES=0
          if [ -n "$HTML_FILES" ]; then
            echo "### ï¿½ **VÃ©rification des styles inline dans le HTML**" >> feedback.md
            echo "" >> feedback.md
            
            for file in $HTML_FILES; do
              INLINE_COUNT=$(grep -c 'style\s*=' "$file" 2>/dev/null || echo 0)
              if [ $INLINE_COUNT -gt 0 ]; then
                INLINE_STYLES=$((INLINE_STYLES + INLINE_COUNT))
              fi
            done
            
            if [ $INLINE_STYLES -gt 0 ]; then
              echo "ğŸš¨ **PROBLÃˆME MAJEUR : $INLINE_STYLES style(s) inline dÃ©tectÃ©(s)**" >> feedback.md
              echo "" >> feedback.md
              
              for file in $HTML_FILES; do
                INLINE_COUNT=$(grep -c 'style\s*=' "$file" 2>/dev/null || echo 0)
                if [ $INLINE_COUNT -gt 0 ]; then
                  echo "âŒ **$INLINE_COUNT style(s) inline dans \`$file\`**" >> feedback.md
                  grep -n 'style\s*=' "$file" | head -5 | while IFS=: read -r line_num style_line; do
                    echo "**Ligne $line_num:** \`$(echo "$style_line" | cut -c1-60)...\`" >> feedback.md
                  done
                  echo "" >> feedback.md
                fi
              done
              
              echo "**ğŸ’¡ SOLUTION URGENTE:** TransfÃ©rez TOUS les styles vers \`style.css\`" >> feedback.md
              echo "" >> feedback.md
              echo "\`\`\`css" >> feedback.md
              echo "/* Dans style.css */" >> feedback.md
              echo ".header { text-align: center; margin: 20px; }" >> feedback.md
              echo ".main-title { color: red; font-size: 28px; }" >> feedback.md
              echo "\`\`\`" >> feedback.md
              echo "" >> feedback.md
              echo "\`\`\`html" >> feedback.md
              echo "<!-- Dans HTML -->" >> feedback.md
              echo '<header class="header">' >> feedback.md
              echo '  <h1 class="main-title">Titre</h1>' >> feedback.md
              echo "\`\`\`" >> feedback.md
              echo "" >> feedback.md
            else
              echo "ğŸ’¡ **EXCELLENT ! Aucun style inline dÃ©tectÃ©**" >> feedback.md
              echo "âœ… **Parfait !** Vous utilisez correctement le CSS externe." >> feedback.md
              echo "âœ… **Bonne pratique respectÃ©e :** SÃ©paration HTML/CSS maÃ®trisÃ©e." >> feedback.md
              echo "" >> feedback.md
            fi
          fi
          
          # ==========================================
          # DÃ‰TECTION DES SÃ‰LECTEURS ID (MAUVAISE PRATIQUE)
          # ==========================================
          
          ID_SELECTORS=0
          echo "### ğŸ†” **VÃ©rification des sÃ©lecteurs ID dans le CSS**" >> feedback.md
          echo "" >> feedback.md
          
          for file in $CSS_FILES; do
            # DÃ©tection des sÃ©lecteurs #id (hors commentaires)
            ID_COUNT=$(grep -cE "^\s*#[a-zA-Z][a-zA-Z0-9_-]*\s*{" "$file" 2>/dev/null || echo 0)
            if [ $ID_COUNT -gt 0 ]; then
              ID_SELECTORS=$((ID_SELECTORS + ID_COUNT))
              echo "âš ï¸ **$ID_COUNT sÃ©lecteur(s) ID dÃ©tectÃ©(s) dans \`$file\`**" >> feedback.md            grep -n -E "^\s*#[a-zA-Z][a-zA-Z0-9_-]*\s*{" "$file" | while IFS=: read -r line_num id_line; do
              ID_NAME=$(echo "$id_line" | sed -E 's/^\s*#([a-zA-Z][a-zA-Z0-9_-]*)\s*{.*/\1/')
              echo "**Ligne $line_num:** \`#$ID_NAME { ... }\`" >> feedback.md
            done
              echo "" >> feedback.md
            fi
          done
          
          if [ $ID_SELECTORS -gt 0 ]; then
            echo "**ğŸ¯ BONNE PRATIQUE MANQUÃ‰E :**" >> feedback.md
            echo "- Les **ID** sont pour l'identification unique (JavaScript, ancres)" >> feedback.md
            echo "- Les **classes** sont pour le styling CSS" >> feedback.md
            echo "" >> feedback.md
            echo "**ğŸ’¡ SOLUTION :**" >> feedback.md
            echo "1. Remplacez \`#mon-id\` par \`.ma-classe\` dans le CSS" >> feedback.md
            echo "2. Remplacez \`id=\"mon-id\"\` par \`class=\"ma-classe\"\` dans le HTML" >> feedback.md
            echo "" >> feedback.md
            echo "**ğŸ”„ EXEMPLE DE CORRECTION :**" >> feedback.md
            echo "\`\`\`css" >> feedback.md
            echo "/* âŒ Mauvais - utilisation d'ID pour styling */" >> feedback.md
            echo "#header { background: blue; }" >> feedback.md
            echo "" >> feedback.md
            echo "/* âœ… Correct - utilisation de classe pour styling */" >> feedback.md
            echo ".header { background: blue; }" >> feedback.md
            echo "\`\`\`" >> feedback.md
            echo "" >> feedback.md
            echo "\`\`\`html" >> feedback.md
            echo "<!-- âŒ Mauvais -->" >> feedback.md
            echo '<div id="header">' >> feedback.md
            echo "" >> feedback.md
            echo "<!-- âœ… Correct -->" >> feedback.md
            echo '<div class="header">' >> feedback.md
            echo "\`\`\`" >> feedback.md
            echo "" >> feedback.md
            ERROR_COUNT=$((ERROR_COUNT + ID_SELECTORS))
          else
            echo "âœ… **Aucun sÃ©lecteur ID dÃ©tectÃ© - Excellente pratique !**" >> feedback.md
            echo "ğŸ’¡ **Bravo !** Vous utilisez correctement les classes pour le styling." >> feedback.md
            echo "" >> feedback.md
          fi
        fi
        
        # ==========================================
        # Ã‰VALUATION SELON BARÃˆME OFFICIEL (15 points)
        # ==========================================
        
        echo "## ğŸ“Š **Ã‰VALUATION SELON LE BARÃˆME OFFICIEL (15 points)**" >> feedback.md
        echo "" >> feedback.md
        
        # 1. RESPECT DE LA MAQUETTE (3 points)
        echo "### ğŸ¨ **1. Respect de la Maquette** (3 points)" >> feedback.md
        if [ "$INLINE_STYLES" -gt 0 ]; then
          SCORE_MAQUETTE=0
          echo "âŒ **DÃ©butant : Insuffisant (0/3 points)**" >> feedback.md
          echo "- Mise en page dÃ©pendante des styles inline" >> feedback.md
          echo "- Aucune utilisation du CSS externe" >> feedback.md
        elif [ "$ERROR_COUNT" -gt 5 ]; then
          SCORE_MAQUETTE=1
          echo "ğŸ“ˆ **Basique : Ã€ AmÃ©liorer (1/3 points)**" >> feedback.md
          echo "- CSS externe utilisÃ© mais avec des erreurs" >> feedback.md
        elif [ "$ERROR_COUNT" -gt 2 ]; then
          SCORE_MAQUETTE=2
          echo "ğŸ‘ **CompÃ©tent : Bien (2/3 points)**" >> feedback.md
          echo "- Bonne approche avec quelques corrections nÃ©cessaires" >> feedback.md
        else
          SCORE_MAQUETTE=3
          echo "ğŸŒŸ **AvancÃ© : Excellent (3/3 points)**" >> feedback.md
          echo "- Mise en page professionnelle et bien structurÃ©e" >> feedback.md
        fi
        echo "" >> feedback.md
        
        # 2. UTILISATION DES SÃ‰LECTEURS CSS (3 points)
        echo "### ğŸ·ï¸ **2. Utilisation des SÃ©lecteurs CSS** (3 points)" >> feedback.md
        if [ "$INLINE_STYLES" -gt 5 ]; then
          SCORE_SELECTORS=0
          echo "âŒ **DÃ©butant : Insuffisant (0/3 points)**" >> feedback.md
          echo "- Aucune utilisation effective des sÃ©lecteurs CSS" >> feedback.md
        elif [ "$INLINE_STYLES" -gt 0 ] || [ "$ID_SELECTORS" -gt 3 ]; then
          SCORE_SELECTORS=1
          echo "ğŸ“ˆ **Basique : Ã€ AmÃ©liorer (1/3 points)**" >> feedback.md
          if [ "$INLINE_STYLES" -gt 0 ]; then
            echo "- Classes dÃ©finies mais styles inline omniprÃ©sents" >> feedback.md
          fi
          if [ "$ID_SELECTORS" -gt 3 ]; then
            echo "- Utilisation excessive des sÃ©lecteurs ID pour le styling" >> feedback.md
          fi
        else
          CLASS_COUNT=$(grep -cE "^\s*\.[a-zA-Z]" $CSS_FILES 2>/dev/null | head -1 || echo 0)
          if [ "$CLASS_COUNT" -ge 5 ] && [ "$ID_SELECTORS" -eq 0 ]; then
            SCORE_SELECTORS=3
            echo "ğŸŒŸ **AvancÃ© : Excellent (3/3 points)**" >> feedback.md
            echo "- Utilisation maÃ®trisÃ©e des classes CSS" >> feedback.md
            echo "- Aucun sÃ©lecteur ID utilisÃ© pour le styling" >> feedback.md
          elif [ "$CLASS_COUNT" -ge 3 ] && [ "$ID_SELECTORS" -le 1 ]; then
            SCORE_SELECTORS=2
            echo "ğŸ‘ **CompÃ©tent : Bien (2/3 points)**" >> feedback.md
            echo "- Bonne utilisation des classes CSS" >> feedback.md
            if [ "$ID_SELECTORS" -eq 1 ]; then
              echo "- Une utilisation mineure d'ID dÃ©tectÃ©e" >> feedback.md
            fi
          else
            SCORE_SELECTORS=1
            echo "ğŸ“ˆ **Basique : Ã€ AmÃ©liorer (1/3 points)**" >> feedback.md
            echo "- Peu de classes dÃ©finies ou trop d'ID utilisÃ©s" >> feedback.md
          fi
        fi
        echo "" >> feedback.md
        
        # 3. TYPOGRAPHIE ET HIÃ‰RARCHIE VISUELLE (3 points)
        echo "### ğŸ“ **3. Typographie et HiÃ©rarchie Visuelle** (3 points)" >> feedback.md
        if [ "$INLINE_STYLES" -gt 0 ]; then
          SCORE_TYPO=0
          echo "âŒ **DÃ©butant : Insuffisant (0/3 points)**" >> feedback.md
          echo "- HiÃ©rarchie dÃ©finie uniquement via styles inline" >> feedback.md
        else
          FONT_PROPS=$(grep -cE "(font-family|font-size|font-weight)" $CSS_FILES 2>/dev/null | head -1 || echo 0)
          if [ "$FONT_PROPS" -ge 4 ]; then
            SCORE_TYPO=3
            echo "ğŸŒŸ **AvancÃ© : Excellent (3/3 points)**" >> feedback.md
          elif [ "$FONT_PROPS" -ge 2 ]; then
            SCORE_TYPO=2
            echo "ğŸ‘ **CompÃ©tent : Bien (2/3 points)**" >> feedback.md
          else
            SCORE_TYPO=1
            echo "ğŸ“ˆ **Basique : Ã€ AmÃ©liorer (1/3 points)**" >> feedback.md
          fi
        fi
        echo "" >> feedback.md
        
        # 4. RESPECT DES BONNES PRATIQUES CSS (3 points)
        echo "### âœ¨ **4. Respect des Bonnes Pratiques CSS** (3 points)" >> feedback.md
        if [ "$INLINE_STYLES" -gt 0 ]; then
          SCORE_PRACTICES=0
          echo "âŒ **DÃ©butant : Insuffisant (0/3 points)**" >> feedback.md
          echo "- **$INLINE_STYLES styles inline** = violation majeure des bonnes pratiques" >> feedback.md
          echo "- SÃ©paration HTML/CSS non respectÃ©e" >> feedback.md
        elif [ "$ERROR_COUNT" -eq 0 ]; then
          SCORE_PRACTICES=3
          echo "ğŸŒŸ **AvancÃ© : Excellent (3/3 points)**" >> feedback.md
          echo "- Code parfaitement structurÃ©" >> feedback.md
        elif [ "$ERROR_COUNT" -le 2 ]; then
          SCORE_PRACTICES=2
          echo "ğŸ‘ **CompÃ©tent : Bien (2/3 points)**" >> feedback.md
          echo "- Bonnes pratiques respectÃ©es avec quelques amÃ©liorations" >> feedback.md
        else
          SCORE_PRACTICES=1
          echo "ğŸ“ˆ **Basique : Ã€ AmÃ©liorer (1/3 points)**" >> feedback.md
          echo "- Code partiellement structurÃ©" >> feedback.md
        fi
        echo "" >> feedback.md
        
        # 5. VALIDATION ET COMPATIBILITÃ‰ (3 points)
        echo "### âœ… **5. Validation et CompatibilitÃ©** (3 points)" >> feedback.md
        if [ "$ERROR_COUNT" -eq 0 ]; then
          SCORE_VALIDATION=3
          echo "ğŸŒŸ **AvancÃ© : Excellent (3/3 points)**" >> feedback.md
          echo "- Code sans erreurs de syntaxe" >> feedback.md
        elif [ "$ERROR_COUNT" -le 2 ]; then
          SCORE_VALIDATION=2
          echo "ğŸ‘ **CompÃ©tent : Bien (2/3 points)**" >> feedback.md
          echo "- Code globalement valide avec quelques avertissements" >> feedback.md
        elif [ "$ERROR_COUNT" -le 5 ]; then
          SCORE_VALIDATION=1
          echo "ğŸ“ˆ **Basique : Ã€ AmÃ©liorer (1/3 points)**" >> feedback.md
          echo "- Plusieurs erreurs nÃ©cessitent correction" >> feedback.md
        else
          SCORE_VALIDATION=0
          echo "âŒ **DÃ©butant : Insuffisant (0/3 points)**" >> feedback.md
          echo "- Code invalide avec erreurs majeures" >> feedback.md
        fi
        echo "" >> feedback.md
        
        # ==========================================
        # CALCUL DU SCORE TOTAL
        # ==========================================
        
        TOTAL_SCORE=$((SCORE_MAQUETTE + SCORE_SELECTORS + SCORE_TYPO + SCORE_PRACTICES + SCORE_VALIDATION))
        PERCENTAGE=$((TOTAL_SCORE * 100 / 15))
        
        echo "## ğŸ¯ **SCORE FINAL : $TOTAL_SCORE/15 ($PERCENTAGE%)**" >> feedback.md
        echo "" >> feedback.md
        echo "| CritÃ¨re | Score | Maximum |" >> feedback.md
        echo "|---------|-------|---------|" >> feedback.md
        echo "| ğŸ¨ Respect de la maquette | $SCORE_MAQUETTE | 3 |" >> feedback.md
        echo "| ğŸ·ï¸ Utilisation des sÃ©lecteurs CSS | $SCORE_SELECTORS | 3 |" >> feedback.md
        echo "| ğŸ“ Typographie et hiÃ©rarchie visuelle | $SCORE_TYPO | 3 |" >> feedback.md
        echo "| âœ¨ Respect des bonnes pratiques CSS | $SCORE_PRACTICES | 3 |" >> feedback.md
        echo "| âœ… Validation et compatibilitÃ© | $SCORE_VALIDATION | 3 |" >> feedback.md
        echo "" >> feedback.md
        
        # Ã‰valuation finale
        if [ "$TOTAL_SCORE" -ge 13 ]; then
          echo "### ğŸŒŸ **AVANCÃ‰ : EXCELLENT !** ($TOTAL_SCORE/15)" >> feedback.md
          echo "ğŸ‰ **FÃ©licitations !** Travail de qualitÃ© professionnelle." >> feedback.md
        elif [ "$TOTAL_SCORE" -ge 10 ]; then
          echo "### ğŸ‘ **COMPÃ‰TENT : BIEN !** ($TOTAL_SCORE/15)" >> feedback.md
          echo "âœ¨ **TrÃ¨s bon travail !** Quelques ajustements et ce sera parfait." >> feedback.md
        elif [ "$TOTAL_SCORE" -ge 7 ]; then
          echo "### ğŸ“ˆ **BASIQUE : Ã€ AMÃ‰LIORER** ($TOTAL_SCORE/15)" >> feedback.md
          echo "ğŸ¯ **Bon dÃ©but !** Concentrez-vous sur les points faibles identifiÃ©s." >> feedback.md
        else
          echo "### ğŸ’ª **DÃ‰BUTANT : CONTINUE TES EFFORTS !** ($TOTAL_SCORE/15)" >> feedback.md
          echo "ğŸŒ± **Ne vous dÃ©couragez pas !** Votre principale mission : **Ã©liminer tous les styles inline**." >> feedback.md
        fi
        echo "" >> feedback.md
        
        # ==========================================
        # PLAN D'ACTION PRIORITAIRE
        # ==========================================
        
        echo "---" >> feedback.md
        echo "" >> feedback.md
        echo "## ğŸš€ **PLAN D'ACTION PRIORITAIRE**" >> feedback.md
        echo "" >> feedback.md
        
        if [ "$INLINE_STYLES" -gt 0 ]; then
          echo "### **Ã‰tape 1 - URGENT (Ã  faire maintenant) :**" >> feedback.md
          echo "1. âŒ **Supprimez TOUS les attributs \`style=\"\"\` du HTML**" >> feedback.md
          echo "2. âœ… **TransfÃ©rez ces styles vers \`style.css\`**" >> feedback.md
          echo "3. âœ… **CrÃ©ez des classes descriptives (.header, .main-title, etc.)**" >> feedback.md
          echo "4. âœ… **Ajoutez les classes correspondantes dans le HTML**" >> feedback.md
          echo "" >> feedback.md
        fi
        
        if [ "$ERROR_COUNT" -gt 0 ]; then
          echo "### **Ã‰tape 2 - Correction des erreurs :**" >> feedback.md
          echo "1. ğŸ”§ **Corrigez les $ERROR_COUNT erreur(s) de syntaxe dÃ©tectÃ©es**" >> feedback.md
          echo "2. âœï¸ **VÃ©rifiez l'orthographe des propriÃ©tÃ©s CSS**" >> feedback.md
          echo "3. ğŸ“ **Ajoutez les unitÃ©s manquantes (px, em, %, etc.)**" >> feedback.md
          echo "" >> feedback.md
        fi
        
        echo "### **Ã‰tape 3 - Validation :**" >> feedback.md
        echo "1. ğŸ‘€ **VÃ©rifiez que votre page s'affiche identiquement**" >> feedback.md
        echo "2. ğŸ” **Validez votre CSS avec le [validateur W3C](https://jigsaw.w3.org/css-validator/)**" >> feedback.md
        echo "3. ğŸ“± **Testez sur diffÃ©rentes tailles d'Ã©cran**" >> feedback.md
        echo "" >> feedback.md
        
        echo "## ğŸ’¡ **CONSEILS DE VOTRE COACH**" >> feedback.md
        echo "" >> feedback.md
        echo "### ğŸ¯ **RÃ¨gle d'or :**" >> feedback.md
        echo "**JAMAIS de \`style=\"\"\` dans le HTML !** C'est la rÃ¨gle nÂ°1 du CSS." >> feedback.md
        echo "" >> feedback.md
        echo "### âœ… **Checklist avant validation :**" >> feedback.md
        
        if [ "$INLINE_STYLES" -gt 0 ]; then
          echo "- [ ] âŒ Aucun attribut \`style=\"\"\` dans le HTML" >> feedback.md
        else
          echo "- [x] âœ… Aucun attribut \`style=\"\"\` dans le HTML" >> feedback.md
        fi
        
        if [ "$ERROR_COUNT" -eq 0 ]; then
          echo "- [x] âœ… Aucune erreur de syntaxe CSS" >> feedback.md
        else
          echo "- [ ] âŒ Aucune erreur de syntaxe CSS" >> feedback.md
        fi
        
        echo "- [ ] Tous les styles dans \`style.css\`" >> feedback.md
        echo "- [ ] Classes CSS bien nommÃ©es et utilisÃ©es" >> feedback.md
        echo "- [ ] Structure HTML valide" >> feedback.md
        echo "" >> feedback.md
        
        echo "---" >> feedback.md
        echo "" >> feedback.md
        echo "ğŸ“ **Feedback gÃ©nÃ©rÃ© automatiquement le $(date '+%d/%m/%Y Ã  %H:%M')**" >> feedback.md
        echo "ğŸ“§ **Questions ?** Contactez votre formateur pour des explications dÃ©taillÃ©es." >> feedback.md
        
        # Exporter les variables
        echo "ERROR_COUNT=$ERROR_COUNT" >> $GITHUB_OUTPUT
        echo "TOTAL_SCORE=$TOTAL_SCORE" >> $GITHUB_OUTPUT
        echo "PERCENTAGE=$PERCENTAGE" >> $GITHUB_OUTPUT
        echo "INLINE_STYLES=$INLINE_STYLES" >> $GITHUB_OUTPUT
    
    - name: ğŸ“ Affichage du Feedback RÃ©aliste
      run: |
        echo "ğŸ¯ === Ã‰VALUATION TERMINÃ‰E ==="
        echo "ğŸ“Š Score: ${{ steps.evaluation.outputs.TOTAL_SCORE }}/15 (${{ steps.evaluation.outputs.PERCENTAGE }}%)"
        echo "ğŸš¨ Erreurs dÃ©tectÃ©es: ${{ steps.evaluation.outputs.ERROR_COUNT }}"
        echo "âš ï¸  Styles inline: ${{ steps.evaluation.outputs.INLINE_STYLES }}"
        echo ""
        echo "ğŸ“‹ AperÃ§u du feedback:"
        head -20 feedback.md

    - name: ğŸ’¾ Commit du Feedback PÃ©dagogique
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "Coach CSS - GitHub Action"
        git add feedback.md
        if git diff --staged --quiet; then
          echo "Aucune modification Ã  commiter"
        else
          git commit -m "ğŸ“ Feedback pÃ©dagogique: ${{ steps.evaluation.outputs.TOTAL_SCORE }}/15 points (${{ steps.evaluation.outputs.ERROR_COUNT }} erreurs, ${{ steps.evaluation.outputs.INLINE_STYLES }} styles inline)"
          git push
          echo "âœ… Feedback pÃ©dagogique sauvegardÃ©"
        fi
